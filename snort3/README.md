Snort3 - —Å–∞–º–∞ —Å–∏—Å—Ç–µ–º–∞ Intrusion Detection Systems (IDS)/IPS (Intrusion Prevention System)

================================
PulledPork ‚Äî —É—Ç–∏–ª—ñ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª –∑—ñ Snort.org (–≤–∫–ª—é—á–Ω–æ –∑ EmergingThreats), 
—ó—Ö —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –≤ —Å–∏—Å—Ç–µ–º—É.

    üîê –ü–æ—Ç—Ä—ñ–±–µ–Ω Oinkcode ‚Äî –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø—É –¥–æ –ø—Ä–∞–≤–∏–ª, 
      —è–∫–∏–π –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –ø—ñ—Å–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –Ω–∞ https://www.snort.org/users/sign_up

    –©–æ —ñ —è–∫ –∫–∞—á–∞—Ç–∏:
https://www.snort.org/oinkcodes

    –°–∞–º –º–æ–¥—É–ª—å, –¥–æ–∫–∏, –∫–æ–Ω—Ñ—ñ–≥–∏:
https://github.com/shirkdog/pulledpork3

=================================
Snort 3 Rule Writing Guide

https://docs.snort.org

=================================

–ü—Ä–∞–≤–∏–ª–æ:
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-WEBAPP perl.exe access"; flow:to_server,established; http_uri; content:"/perl.exe",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:cve,1999-0509; reference:nessus,10173; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:832; rev:25; )

–ô–û–ì–û –†–û–ó–ë–Ü–†:
–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ü—Ä–∞–≤–∏–ª–∞:

    alert: –¶–µ –¥—ñ—è –ø—Ä–∞–≤–∏–ª–∞ (action). –í–æ–Ω–∞ –≤–∫–∞–∑—É—î Snort, —â–æ —Ä–æ–±–∏—Ç–∏, –∫–æ–ª–∏ –ø—Ä–∞–≤–∏–ª–æ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î. alert –æ–∑–Ω–∞—á–∞—î –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è (alert) —Ç–∞ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç. –Ü–Ω—à—ñ –º–æ–∂–ª–∏–≤—ñ –¥—ñ—ó –≤–∫–ª—é—á–∞—é—Ç—å:
        log: –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç –±–µ–∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è.
        pass: –Ü–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç (–Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –π–æ–≥–æ –¥–∞–ª—ñ –∑–∞ —ñ–Ω—à–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏).
        drop: –ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç —Ç–∞ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –π–æ–≥–æ (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º—ñ IPS - Intrusion Prevention System).
        reject: –ë–ª–æ–∫—É–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç —ñ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–∞–∫–µ—Ç TCP RST –∞–±–æ ICMP Unreachable –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞ –ø—Ä–æ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è.

    tcp: –¶–µ –ø—Ä–æ—Ç–æ–∫–æ–ª. –í–∫–∞–∑—É—î, —è–∫–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è –º–∞—î –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏—Å—è —Ü–∏–º –ø—Ä–∞–≤–∏–ª–æ–º. –ú–æ–∂–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è: tcp, udp, icmp, ip (–¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ IP-–ø—Ä–æ—Ç–æ–∫–æ–ª—É).

    $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS: –¶–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –¥–∂–µ—Ä–µ–ª–æ —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è.
        $EXTERNAL_NET: –¶–µ –∑–º—ñ–Ω–Ω–∞ Snort, —è–∫–∞ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∑–Ω–∞—á–∞—î –º–µ—Ä–µ–∂—ñ –∑–∞ –º–µ–∂–∞–º–∏ –≤–∞—à–æ—ó –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –º–µ—Ä–µ–∂—ñ. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö —Ä–æ–±–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –±—ñ–ª—å—à –≥–Ω—É—á–∫–∏–º–∏ —Ç–∞ –ª–µ–≥–∫–∏–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è.
        any: –¶–µ –ø–æ—Ä—Ç –¥–∂–µ—Ä–µ–ª–∞. –í–∫–∞–∑—É—î, —â–æ –ø—Ä–∞–≤–∏–ª–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ —Ç—Ä–∞—Ñ—ñ–∫—É –∑ –±—É–¥—å-—è–∫–æ–≥–æ –ø–æ—Ä—Ç—É –¥–∂–µ—Ä–µ–ª–∞. –ú–æ–∂–Ω–∞ –≤–∫–∞–∑–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 80), –¥—ñ–∞–ø–∞–∑–æ–Ω –ø–æ—Ä—Ç—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 1024:) –∞–±–æ —Å–ø–∏—Å–æ–∫ –ø–æ—Ä—Ç—ñ–≤ —á–µ—Ä–µ–∑ –∫–æ–º—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 80,443).
        ->: –¶–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞–ø—Ä—è–º–∫—É. –í–∫–∞–∑—É—î –Ω–∞–ø—Ä—è–º–æ–∫ —Ç—Ä–∞—Ñ—ñ–∫—É, —è–∫–∏–π —Ü—ñ–∫–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ. -> –æ–∑–Ω–∞—á–∞—î —Ç—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥ –¥–∂–µ—Ä–µ–ª–∞ –¥–æ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è. <> –æ–∑–Ω–∞—á–∞—î —Ç—Ä–∞—Ñ—ñ–∫ –≤ –æ–±–æ—Ö –Ω–∞–ø—Ä—è–º–∫–∞—Ö.
        $HTTP_SERVERS: –©–µ –æ–¥–Ω–∞ –∑–º—ñ–Ω–Ω–∞ Snort, —è–∫–∞ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∑–Ω–∞—á–∞—î IP-–∞–¥—Ä–µ—Å–∏ –≤–∞—à–∏—Ö –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ñ–≤.
        $HTTP_PORTS: –ó–º—ñ–Ω–Ω–∞ Snort, —â–æ –≤–∏–∑–Ω–∞—á–∞—î –ø–æ—Ä—Ç–∏, –Ω–∞ —è–∫–∏—Ö –ø—Ä–∞—Ü—é—é—Ç—å –≤–∞—à—ñ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∏ (–∑–∞–∑–≤–∏—á–∞–π 80, 443 —Ç–æ—â–æ).

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∞–≤–∏–ª–∞ alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS –≥–æ–≤–æ—Ä–∏—Ç—å Snort –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ TCP-—Ç—Ä–∞—Ñ—ñ–∫—É, —â–æ –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –∑ –±—É–¥—å-—è–∫–æ–≥–æ –ø–æ—Ä—Ç—É —ñ–∑ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó –º–µ—Ä–µ–∂—ñ ($EXTERNAL_NET) –Ω–∞ –±—É–¥—å-—è–∫–∏–π –∑ –ø–æ—Ä—Ç—ñ–≤ HTTP ($HTTP_PORTS) –Ω–∞ –≤–∞—à—ñ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∏ ($HTTP_SERVERS).
–û–ø—Ü—ñ—ó –ü—Ä–∞–≤–∏–ª–∞:

–û–ø—Ü—ñ—ó –ø—Ä–∞–≤–∏–ª–∞ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ –¥—É–∂–∫–∞—Ö () —ñ —Ä–æ–∑–¥—ñ–ª—è—é—Ç—å—Å—è –∫—Ä–∞–ø–∫–æ—é –∑ –∫–æ–º–æ—é ;. –í–æ–Ω–∏ –Ω–∞–¥–∞—é—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É.

    msg:"SERVER-WEBAPP perl.exe access";: –¶–µ –æ–ø—Ü—ñ—è msg. –í–æ–Ω–∞ –≤–∏–∑–Ω–∞—á–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫–µ –±—É–¥–µ –≤–∫–ª—é—á–µ–Ω–æ –¥–æ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è Snort –ø—Ä–∏ —Å–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞–Ω–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —â–æ —Å–∞–º–µ –≤–∏—è–≤–∏–ª–æ –ø—Ä–∞–≤–∏–ª–æ.

    flow:to_server,established;: –¶–µ –æ–ø—Ü—ñ—è flow. –í–æ–Ω–∞ –≤–∫–∞–∑—É—î –Ω–∞ —Å—Ç–∞–Ω TCP-–∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ø—Ä—è–º–æ–∫ –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö, —è–∫–∏–π –º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—É.
        to_server: –í–∫–∞–∑—É—î, —â–æ –ø—Ä–∞–≤–∏–ª–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ –ø–∞–∫–µ—Ç—ñ–≤, —â–æ –π–¥—É—Ç—å –≤—ñ–¥ –∫–ª—ñ—î–Ω—Ç–∞ –¥–æ —Å–µ—Ä–≤–µ—Ä–∞.
        established: –í–∫–∞–∑—É—î, —â–æ –ø—Ä–∞–≤–∏–ª–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –ª–∏—à–µ –¥–æ –ø–∞–∫–µ—Ç—ñ–≤, —â–æ —î —á–∞—Å—Ç–∏–Ω–æ—é –≤–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ TCP-–∑'—î–¥–Ω–∞–Ω–Ω—è (—Ç–æ–±—Ç–æ, –ø—ñ—Å–ª—è —Ç—Ä–∏—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è TCP). –Ü–Ω—à—ñ –º–æ–∂–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∫–ª—é—á–∞—é—Ç—å to_client, from_server, from_client, stateless.

    http_uri;: –¶–µ –æ–ø—Ü—ñ—è –¥–µ–∫–æ–¥–µ—Ä–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä–∞. –í–∫–∞–∑—É—î Snort –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –æ—Ç—Ä–∏–º–∞–Ω—É HTTP-–ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä–æ–º, –∑–æ–∫—Ä–µ–º–∞ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ URI –∑–∞–ø–∏—Ç—É.

    content:"/perl.exe",fast_pattern,nocase;: –¶–µ –æ–ø—Ü—ñ—è content. –¶–µ –æ–¥–Ω–∞ –∑ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö –æ–ø—Ü—ñ–π –¥–ª—è –ø–æ—à—É–∫—É —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π –±–∞–π—Ç—ñ–≤ (–∫–æ–Ω—Ç–µ–Ω—Ç—É) –≤ –ø–∞–∫–µ—Ç—ñ.
        "/perl.exe": –¶–µ —Ä—è–¥–æ–∫, —è–∫–∏–π Snort —à—É–∫–∞—Ç–∏–º–µ –≤ –ø–∞–∫–µ—Ç—ñ. –£ –¥–∞–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ —Ä—è–¥–æ–∫ /perl.exe.
        fast_pattern: –¶—è –æ–ø—Ü—ñ—è –≤–∫–∞–∑—É—î Snort –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π content —è–∫ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —à–∞–±–ª–æ–Ω –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ—à—É–∫—É. –¶–µ –æ–ø—Ç–∏–º—ñ–∑—É—î –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, –¥–æ–∑–≤–æ–ª—è—é—á–∏ Snort —à–≤–∏–¥–∫–æ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –±—ñ–ª—å—à—ñ—Å—Ç—å –ø–∞–∫–µ—Ç—ñ–≤, —è–∫—ñ –Ω–µ –º—ñ—Å—Ç—è—Ç—å —Ü—ñ—î—ó –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ.
        nocase: –¶—è –æ–ø—Ü—ñ—è –≤–∫–∞–∑—É—î Snort —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ä–µ–≥—ñ—Å—Ç—Ä –ø—Ä–∏ –ø–æ—à—É–∫—É –∫–æ–Ω—Ç–µ–Ω—Ç—É. –¢–æ–±—Ç–æ, "perl.exe", "PERL.EXE" —ñ "pErL.eXe" –±—É–¥—É—Ç—å –≤–≤–∞–∂–∞—Ç–∏—Å—è –∑–±—ñ–≥–æ–º.

    metadata:policy max-detect-ips drop,ruleset community;: –¶–µ –æ–ø—Ü—ñ—è metadata. –í–æ–Ω–∞ –Ω–∞–¥–∞—î –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø—Ä–∞–≤–∏–ª–æ, —è–∫–∞ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—ó, –ø—Ä—ñ–æ—Ä–∏—Ç–µ–∑–∞—Ü—ñ—ó –∞–±–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª–∞–º–∏.
        policy max-detect-ips drop: –¶—è –º–µ—Ç–∞–¥–∞—Ç–∞ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è —Å–∏—Å—Ç–µ–º–∞–º–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è Snort –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫. –£ –¥–∞–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–æ–Ω–∞, –π–º–æ–≤—ñ—Ä–Ω–æ, –≤–∫–∞–∑—É—î, —â–æ –≤ —Ä–µ–∂–∏–º—ñ IPS –¥–ª—è —Ü—å–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∞ –ø–æ–ª—ñ—Ç–∏–∫–∞ "drop".
        ruleset community: –í–∫–∞–∑—É—î, —â–æ —Ü–µ –ø—Ä–∞–≤–∏–ª–æ –Ω–∞–ª–µ–∂–∏—Ç—å –¥–æ –Ω–∞–±–æ—Ä—É –ø—Ä–∞–≤–∏–ª "community" (—Å–ø—ñ–ª—å–Ω–æ—Ç–∞), —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —î –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–º–∏ —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è —Å–ø—ñ–ª—å–Ω–æ—Ç–æ—é Snort.

    service:http;: –¶–µ –æ–ø—Ü—ñ—è service. –í–æ–Ω–∞ –≤–∫–∞–∑—É—î, —â–æ —Ü–µ –ø—Ä–∞–≤–∏–ª–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ —Ç—Ä–∞—Ñ—ñ–∫—É, —è–∫–∏–π Snort —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞–≤ —è–∫ HTTP-—Å–µ—Ä–≤—ñ—Å. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î Snort –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä–∏ —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É.

    reference:cve,1999-0509;: –¶–µ –æ–ø—Ü—ñ—è reference. –í–æ–Ω–∞ –Ω–∞–¥–∞—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ –≤–∏—è–≤–ª–µ–Ω–æ—é –∑–∞–≥—Ä–æ–∑–æ—é.
        cve,1999-0509: –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —É –∑–∞–≥–∞–ª—å–Ω—ñ–π –±–∞–∑—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ –≤–ø–ª–∏–≤—ñ–≤ (CVE). CVE-1999-0509 –ø–æ–≤'—è–∑–∞–Ω–∞ –∑ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é, —â–æ –¥–æ–∑–≤–æ–ª—è—î –¥–æ—Å—Ç—É–ø –¥–æ /perl.exe —á–µ—Ä–µ–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä.

    reference:nessus,10173;: –©–µ –æ–¥–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∑–æ–≤–Ω—ñ—à–Ω—î –¥–∂–µ—Ä–µ–ª–æ, —Ü—å–æ–≥–æ —Ä–∞–∑—É –Ω–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö —Å–∫–∞–Ω–µ—Ä–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π Nessus.

    reference:url,www.cert.org/advisories/CA-1996-11.html;: –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π URL-–∞–¥—Ä–µ—Å—É –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤—ñ–¥ CERT.

    classtype:attempted-recon;: –¶–µ –æ–ø—Ü—ñ—è classtype. –í–æ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑—É—î —Ç–∏–ø –∞—Ç–∞–∫–∏ –∞–±–æ –º–µ—Ä–µ–∂–µ–≤–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, —è–∫—É –≤–∏—è–≤–ª—è—î –ø—Ä–∞–≤–∏–ª–æ. attempted-recon –æ–∑–Ω–∞—á–∞—î —Å–ø—Ä–æ–±—É —Ä–æ–∑–≤—ñ–¥–∫–∏ –∞–±–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è. –Ü–Ω—à—ñ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤–∫–ª—é—á–∞—é—Ç—å web-application-attack, trojan-activity —Ç–æ—â–æ.

    sid:832;: –¶–µ –æ–ø—Ü—ñ—è sid (Snort ID). –¶–µ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ Snort. –í—ñ–Ω —î –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Snort –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø—Ä–∞–≤–∏–ª. SID —É –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ 1-1000 –∑–∞—Ä–µ–∑–µ—Ä–≤–æ–≤–∞–Ω—ñ –¥–ª—è –±–∞–∑–æ–≤–∏—Ö –ø—Ä–∞–≤–∏–ª Snort, –∞ –≤–∏—â—ñ –Ω–æ–º–µ—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –ø—Ä–∞–≤–∏–ª, —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –∞–±–æ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º–∏ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞–º–∏.

    rev:25;: –¶–µ –æ–ø—Ü—ñ—è rev (revision). –í–∫–∞–∑—É—î –Ω–æ–º–µ—Ä —Ä–µ–≤—ñ–∑—ñ—ó –ø—Ä–∞–≤–∏–ª–∞. –ö–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –ø—Ä–∞–≤–∏–ª–æ –∑–º—ñ–Ω—é—î—Ç—å—Å—è, –Ω–æ–º–µ—Ä —Ä–µ–≤—ñ–∑—ñ—ó –º–∞—î –∑–±—ñ–ª—å—à—É–≤–∞—Ç–∏—Å—è. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –≤–µ—Ä—Å—ñ—ó –ø—Ä–∞–≤–∏–ª.



================================================
–Ø–∫ –ü–∏—Å–∞—Ç–∏ –°–≤–æ—ó –ü—Ä–∞–≤–∏–ª–∞
–û—Å—å –ø–æ–∫—Ä–æ–∫–æ–≤–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è Snort –ø—Ä–∞–≤–∏–ª:

1) –í–∏–∑–Ω–∞—á—Ç–µ –º–µ—Ç—É –ø—Ä–∞–≤–∏–ª–∞: –©–æ —Å–∞–º–µ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏—è–≤–∏—Ç–∏? (–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–ø—Ä–æ–±—É –¥–æ—Å—Ç—É–ø—É –¥–æ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–≥–æ —Ñ–∞–π–ª—É –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ñ, –ø–µ–≤–Ω–∏–π —Ç–∏–ø —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É, —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤).
2) –û–±–µ—Ä—ñ—Ç—å –¥—ñ—é –ø—Ä–∞–≤–∏–ª–∞: –©–æ Snort –º–∞—î —Ä–æ–±–∏—Ç–∏ –ø—Ä–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—ñ? (alert, log, drop, reject).
3) –í–∫–∞–∂—ñ—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª: –Ø–∫–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ç—Ä–∞—Ñ—ñ–∫, —è–∫–∏–π –≤–∏ –∞–Ω–∞–ª—ñ–∑—É—î—Ç–µ? (tcp, udp, icmp, ip).
4) –í–∏–∑–Ω–∞—á—Ç–µ –¥–∂–µ—Ä–µ–ª–æ —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: –í–∫–∞–∂—ñ—Ç—å IP-–∞–¥—Ä–µ—Å–∏/–∑–º—ñ–Ω–Ω—ñ —Ç–∞ –ø–æ—Ä—Ç–∏ –¥–∂–µ—Ä–µ–ª–∞ —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è, –∞ —Ç–∞–∫–æ–∂ –Ω–∞–ø—Ä—è–º–æ–∫ —Ç—Ä–∞—Ñ—ñ–∫—É (-> –∞–±–æ <>). –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∑–º—ñ–Ω–Ω—ñ ($HOME_NET, $EXTERNAL_NET, $HTTP_SERVERS, $HTTP_PORTS —Ç–æ—â–æ) –¥–ª—è –≥–Ω—É—á–∫–æ—Å—Ç—ñ.
5) –î–æ–¥–∞–π—Ç–µ –æ–ø—Ü—ñ—é msg: –ù–∞–ø–∏—à—ñ—Ç—å —á—ñ—Ç–∫–µ —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫–µ –æ–ø–∏—Å—É—î, —â–æ –≤–∏—è–≤–ª—è—î –ø—Ä–∞–≤–∏–ª–æ.
6) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–ø—Ü—ñ—é flow: –í–∫–∞–∂—ñ—Ç—å —Å—Ç–∞–Ω –∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ø—Ä—è–º–æ–∫ –ø–æ—Ç–æ–∫—É, —è–∫—â–æ —Ü–µ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è –≤–∞—à–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞.
7) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–ø—Ü—ñ—ó –∫–æ–Ω—Ç–µ–Ω—Ç—É (content, byte_test, pcre —Ç–æ—â–æ): –¶–µ –æ—Å–Ω–æ–≤–Ω–∏–π —Å–ø–æ—Å—ñ–± —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É. –®—É–∫–∞–π—Ç–µ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ —Ä—è–¥–∫–∏, –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –±–∞–π—Ç—ñ–≤ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏. –ù–µ –∑–∞–±—É–≤–∞–π—Ç–µ –ø—Ä–æ –æ–ø—Ü—ñ—ó nocase –¥–ª—è —ñ–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è —Ä–µ–≥—ñ—Å—Ç—Ä—É —Ç–∞ fast_pattern –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó.
8) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–ø—Ü—ñ—ó –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ (http_uri, dce_opnum —Ç–æ—â–æ): –Ø–∫—â–æ –ø—Ä–∞–≤–∏–ª–æ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –æ–±—Ä–æ–±–ª–µ–Ω–æ—ó –ø–µ–≤–Ω–∏–º –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä–æ–º, –¥–æ–¥–∞–π—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –æ–ø—Ü—ñ—é.
9) –î–æ–¥–∞–π—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è (reference): –í–∫–∞–∂—ñ—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ CVE, –±—é–ª–µ—Ç–µ–Ω—ñ –±–µ–∑–ø–µ–∫–∏ –∞–±–æ —ñ–Ω—à—ñ —Ä–µ—Å—É—Ä—Å–∏ –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.
10) –ü—Ä–∏–∑–Ω–∞—á—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é (classtype): –ö–ª–∞—Å–∏—Ñ—ñ–∫—É–π—Ç–µ —Ç–∏–ø –≤–∏—è–≤–ª–µ–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.
11) –ü—Ä–∏–∑–Ω–∞—á—Ç–µ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π SID: –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∞—à SID –Ω–µ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É—î –∑ —ñ—Å–Ω—É—é—á–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏. –î–ª—è –≤–ª–∞—Å–Ω–∏—Ö –ø—Ä–∞–≤–∏–ª —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ SID —É –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ 1,000,000 —ñ –≤–∏—â–µ.
12) –í–∫–∞–∂—ñ—Ç—å —Ä–µ–≤—ñ–∑—ñ—é (rev): –ü–æ—á–Ω—ñ—Ç—å –∑ rev:1 —ñ –∑–±—ñ–ª—å—à—É–π—Ç–µ –Ω–æ–º–µ—Ä –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞.
13) –î–æ–¥–∞–π—Ç–µ –º–µ—Ç–∞–¥–∞–Ω—ñ (metadata): –í–∫–∞–∂—ñ—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø—Ä–∞–≤–∏–ª–æ, —è–∫—â–æ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–ª—è –≤–∞—à–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.

